# ADISE23_HLMA it175118 it175085
=================================
===============
   * [Demo Game page](#demo-game-page)
   * [Εγκατάσταση](#εγκατάσταση)
      * [Απαιτήσεις](#απαιτήσεις)
      * [Οδηγίες Εγκατάστασης](#οδηγίες-εγκατάστασης)
   * [Περιγραφή API](#περιγραφή-api)
      * [Methods](#methods)
         * [Board](#board)
            * [Ανάγνωση του Main Board και του Target Board](#ανάγνωση-board)
            * [Ενημέρωση Main Board](#ενημέωρση-main-board)
            * [Ενημέρωση Target Board](#ενημέωρση-target-board)
         * [Game-Status](#game-status)
            * [Ανάνγωνση Game status](#ανάγνωση-game-status)
         * [Player](#player)
            * [Ανάγνωση στοιχείου κατάστασης του παίκτη](#ανάγνωση-στοιχείου-κατάστασης-παίκτη)
            * [Καθορισμός στοιχείων παίκτη](#καθορισμός-στοιχείων-παίκτη)
      * [Entities](#entities)
         * [Board](#board-1)
            * [BlueMain](#bluemain)
            * [BlueMain_Empty](#bluemain_empty)
            * [RedMain](#redmain)
            * [RedMain_Empty](#redmain_empty)
            * [BlueTarget](#bluetarget)
            * [BlueTarget_Empty](#bluetarget_empty)
            * [RedTarget](#redtarget)
            * [RedTarget_Empty](#redtarget_empty)
         * [Players](#players)
         * [Game_status](#game_status)
         * [Game](#game)

# Demo Game Page

    Μπορείτε να κατεβάσετε τοπικά ή να επισκεφτείτε τη σελίδα: 
    https://users.iee.ihu.gr/~it175118/ADISE23_HLMA/www/

# Εγκατάσταση 

## Απαιτήσεις

    * Apache2
    * Mysql Server
    * php

## Οδηγίες Εγκατάστασης

    * Κάντε clone το project σε κάποιον φάκελο <br/>
    `$ git clone https://github.com/iee-ihu-gr-course1941/ADISE23_HLMA.git`

    * Βεβαιωθείτε ότι ο φάκελος είναι προσβάσιμος από τον Apache Server. Πιθανόν να χρειαστεί να καθορίσετε τις παρακάτω ρυθμίσεις.

    * Θα πρέπει να δημιουργήσετε στην Mysql την βάση με όνομα 'naymaxia' και να φορτώσετε σε αυτήν τη βάση τα δεδομένα από το αρχείο schema.sql

    * Θα πρέπει να φτιάξετε το αρχείο lib/db_upass.php το οποίο να περιέχει:
    ```
        <?php
        $DB_PASS = 'κωδικός';
        $DB_USER = 'όνομα χρήστη';
        ?>
    ```


# Περιγραφή Παιχνιδιού

Η ναυμαχία παίζεται ως εξής: Δύο αντίπαλοι παίκτες με κόκκινο και μπλε χρώμα αντίστοιχα, τοποθετόυν τα τέσσερα πλοία τους, που έχουν διαφορετικό μήκος, στο board(Main board) που βλέπουν μόνο οι ίδιοι. Αφού έχουν τοποθετήσει και οι δύο παίκτες τα πλοία τους, παίζουν εναλλάξ, προσπαθώντας να βυθίσουν τα πλοία του αντιπάλου. Χρησιμοποιούν ένα δεύτερο board(Target board) με ίδιο αριθμό στηλών και γραμμών με του Main board, όπου αναπαριστά τις βολές τους και στην περίπτωση που έχουν πετύχει πλοίο του αντιπάλου σημειώνεται με εναν κύκλο ενώ αν αστοχήσουν εμφανιζεται ενα Χ.

Οι κανόνες είναι ως εξής: Κάθε παιχνίδι παίζεται από δύο άτομα αυστηρά. Κάθε παίκτης πρέπει να τοποθετήσει στο Main board του και τα τέσσερα διαφορετικού μήκους πλοία(Υποβρύχιο 2 θεσεις,...). Ο κάθε παίκτης μπορεί να δει το δικό του Main board και μόνο. Νικάει όποιος βυθίσει πρώτος όλα τα πλοία του αντιπάλου.

Η βάση μας κρατάει τους εξής πίνακες και στοιχεία :
Game:
    game_id

Game_Status:
    game_id
    status
    p_turn
    result
    last_change

Players:
    game_id
    username
    piece_color
    token
    last_action
    ready

BlueMain:
    game_id
    x
    y
    piece

RedMain:
    game_id
    x
    y
    piece


BlueTarget:
    game_id
    x
    y
    piece

RedTarget:
    game_id
    x
    y
    piece


BlueMain_Empty:
    game_id
    x
    y
    piece

RedMain_Empty:
    game_id
    x
    y
    piece


BlueTarget_Empty:
    game_id
    x
    y
    piece

RedTarget_Empty:
    game_id
    x
    y
    piece



| Η εφαρμογή αναπτύχθηκε μέχρι το σημείο | Υλοποιήθηκε (X) / Δεν υλοποιήθηκε ( ) |
| --------------------------------------- | -------------------------------------------- |
| Αρχικοποίηση σύνδεσης-authentication (ακόμη και χωρίς password) - 1 ή 2 άτομα. | [X] |
| Έλεγχος κανόνων παιχνιδιού. | [X] |
| Αναγνώριση σειράς παιξιάς. | [X] |
| Αναγνώριση DeadLock (δεν υπάρχει κίνηση ή τέλος παιχνιδιού). | [X] |
| Το API πρέπει να χρησιμοποιεί json μορφή για τα δεδομένα. | [X] |
| Διευκρίνηση για το GUI: | |
|   - Το GUI σημαίνει “γραφική εμφάνιση” του board. Μπορεί η εντολή κίνησης να δίνεται από textarea/input text και όχι με το ποντίκι. | [X] |
|   - Βασικό GUI σημαίνει “εμφάνιση του board με κείμενο”. Η εντολή κίνησης δίνεται από textarea/input text ή από cli με curl/wget/etc ή από postman. | [ ] |
| Η κατάσταση του παιχνιδιού αποθηκεύεται πλήρως σε mysql. | [X] |
| Ο πρώτος παίκτης αρχικοποιεί το board και περιμένει αντίπαλο όπου χρειάζεται. | [X] |
| Authentication μέσω apps. | [ ] |
| Πολλά σύγχρονα boards (του ίδιου παιχνιδιού). | [X] |
| Καταγραφή Score/πόντων παικτών. Scoreboard. | [ ] |
| Έλεγχος timeout → ακύρωση παίκτη | [X] |



## Συντελεστές

Περιγράψτε τις αρμοδιότητες της ομάδας.

Μανιατάκος Γεώργιος(175118): Jquery PHP API

Μαραντίδης Ηλίας(175085): Σχεδιασμός mysql GUI



# Περιγραφή API

## Methods


### Board
#### Ανάγνωση του Main Board και του Target Board

```
POST /game/
```

Παίρνει το token του παίκτη και επιστρέφει το [Board](#Board) του συγκεκριμένου παιχνιδιού για το συγκεκριμένο παίκτη.

#### Ενημέρωση Main Board (τοποθέτηση πλοίου)
```
PUT /game/piece/
```


Ελέγχει αν η εντολή τοποθέτησης για το πλοίο είναι ορθή και αν ναι τοποθετεί το πλοίο στο [Board](#Board) για το συγκεκριμένο παιχνίδι για το συγκεκριμένο παίκτη 


Json Data:

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `x1`              | αρχική συντεταγμένη Χ για το πλοίο | yes        |
| `y1`           | αρχική συντεταγμένη Υ για το πλοίο. | yes        |
| `x2`        | τελική συντεταγμένη Χ για το πλοίο | yes        |
| `y2`           | τελική συντεταγμένη Υ για το πλοίο | yes        |

#### Ενημέρωση Target Board (τοποθέτηση βολής)

```
PUT /game/XO/
```

Κάνει την κίνηση του πιονιού από την θέση x,y στην νέα θέση. Προφανώς ελέγχεται η κίνηση αν είναι νόμιμη καθώς και αν είναι η σειρά του παίκτη να παίξει με βάση το token.

Ελέγχει αν οι συντεταγμένες είναι σωστές και αν έχει ήδη πραγματοποιήσει βολή στις συγκεκριμένες συντεταγμένες.Αφού περάσει επιτυχώς τον έλεγχο ενημερώνει του πίνακες και επιστρέφει αν η βολή βρήκε στόχο ή όχι.
Επιστρέφει τα στοιχεία από το [Board](#Board)


Json Data:

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `x`              | συντεταγμένη Χ για βολή | yes        |
| `y`           | συντεταγμένη Υ για βολή | yes        |

### Game status
#### Ανάγνωση Game status

```
POST /status/
```
Ελέγχει αν το token που έχει διαβάσει από τον header αντιστοιχεί σε παίκτη και επιστρέφει τις πληροφορίες για τον συγκεκριμένο παίκτη στο παιχνίδι από το οποίο κλήθηκε( καθώς μπορεί ένας παίκτης με ίδιο username να παίζει σε παραπάνω από ένα παιχνίδια)


### Player

#### Ανάγνωση στοιχείου κατάστασης του παίκτη
```
POST /status/ready/
```

Επιστρέφει αν ο συγκεκριμένος παίκτης πληροί τις προυποθέσεις ώστε να ξεκινήσει το παιχνίδι( αν έχει τοποθετήσει όλα του τα πλοία)

#### Καθορισμός στοιχείων παίκτη
```
PUT /players/:p_color
```
Json Data:

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `username`        | Το username για τον παίκτη p. | yes        |
| `color`           | To χρώμα που επέλεξε ο παίκτης p. | yes        |


Επιστρέφει τα στοιχεία του παίκτη p_color και ένα token. Το token πρέπει να το χρησιμοποιεί ο παίκτης καθ'όλη τη διάρκεια του παιχνιδιού.


## Entities

### Board

#### BlueMain
---------

Το BlueMain είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `game_id`                | Αντιστοίχιση σε ποιό game υπάγεται           | int                                 |
| `x`                      | H συντεταγμένη x του τετραγώνου              | 1..10                               |
| `y`                      | H συντεταγμένη y του τετραγώνου              | 1..10                               |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           | 'AE1','AE2','AE3','AE4','AE5','AN1','AN2','AN3','AN4','PO1','PO2','PO3','YP1','YP2','AER1','AER2','AER3','AER4','AER5','ANR1','ANR2','ANR3','ANR4','POR1','POR2','POR3','YPR1','YPR2','X','O', 'NULL'       |


#### BlueMain_Empty
---------

Το BlueMain_Empty είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `game_id`                | Αντιστοίχιση σε ποιό game υπάγεται           | int                                 |
| `x`                      | H συντεταγμένη x του τετραγώνου              | 1..10                               |
| `y`                      | H συντεταγμένη y του τετραγώνου              | 1..10                               |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           | 'AE1','AE2','AE3','AE4','AE5','AN1','AN2','AN3','AN4','PO1','PO2','PO3','YP1','YP2','AER1','AER2','AER3','AER4','AER5','ANR1','ANR2','ANR3','ANR4','POR1','POR2','POR3','YPR1','YPR2','X','O', 'NULL'       |


#### RedMain
---------

Το RedMain είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `game_id`                | Αντιστοίχιση σε ποιό game υπάγεται           | int                                 |
| `x`                      | H συντεταγμένη x του τετραγώνου              | 1..10                               |
| `y`                      | H συντεταγμένη y του τετραγώνου              | 1..10                               |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           | 'AE1','AE2','AE3','AE4','AE5','AN1','AN2','AN3','AN4','PO1','PO2','PO3','YP1','YP2','AER1','AER2','AER3','AER4','AER5','ANR1','ANR2','ANR3','ANR4','POR1','POR2','POR3','YPR1','YPR2','X','O', 'NULL'       |


#### RedMain_Empty
---------

Το RedMain_Empty είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `game_id`                | Αντιστοίχιση σε ποιό game υπάγεται           | int                                 |
| `x`                      | H συντεταγμένη x του τετραγώνου              | 1..10                               |
| `y`                      | H συντεταγμένη y του τετραγώνου              | 1..10                               |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           | 'AE1','AE2','AE3','AE4','AE5','AN1','AN2','AN3','AN4','PO1','PO2','PO3','YP1','YP2','AER1','AER2','AER3','AER4','AER5','ANR1','ANR2','ANR3','ANR4','POR1','POR2','POR3','YPR1','YPR2','X','O', 'NULL'       |


#### BlueTarget
---------

Το BlueTarget είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `game_id`                | Αντιστοίχιση σε ποιό game υπάγεται           | int                                 |
| `x`                      | H συντεταγμένη x του τετραγώνου              | 1..10                               |
| `y`                      | H συντεταγμένη y του τετραγώνου              | 1..10                               |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           | 'X','O', 'NULL'                     |


#### BlueTarget_Empty
---------

Το BlueTarget_Empty είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `game_id`                | Αντιστοίχιση σε ποιό game υπάγεται           | int                                 |
| `x`                      | H συντεταγμένη x του τετραγώνου              | 1..10                               |
| `y`                      | H συντεταγμένη y του τετραγώνου              | 1..10                               |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           | 'X','O', 'NULL'                     |


#### RedTarget
---------

Το RedTarget είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `game_id`                | Αντιστοίχιση σε ποιό game υπάγεται           | int                                 |
| `x`                      | H συντεταγμένη x του τετραγώνου              | 1..10                               |
| `y`                      | H συντεταγμένη y του τετραγώνου              | 1..10                               |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           | 'X','O', 'NULL'                     |


#### RedTarget_Empty
---------

Το RedTarget_Empty είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `game_id`                | Αντιστοίχιση σε ποιό game υπάγεται           | int                                 |
| `x`                      | H συντεταγμένη x του τετραγώνου              | 1..10                               |
| `y`                      | H συντεταγμένη y του τετραγώνου              | 1..10                               |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           | 'X','O', 'NULL'                     |


### Players
---------

O κάθε παίκτης έχει τα παρακάτω στοιχεία:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `game_id`                | Αντιστοίχιση σε ποιό game υπάγεται           | int                                 |
| `username`               | Όνομα παίκτη                                 | String,'NULL'                       |
| `piece_color`            | To χρώμα που παίζει ο παίκτης                | 'B','W'                             |
| `token  `                | To κρυφό token του παίκτη. Επιστρέφεται μόνο τη στιγμή της εισόδου του παίκτη στο παιχνίδι | HEX |
| `last_action`            | Πότε έκανε την τελευταία ενέργεια στο παιχνίδι          | timestamp                             |
| `ready`                | Εάν έχει τοποθετήσει όλα τα πλοία          | 'Yes','No'                                 |


### Game_status
---------

H κατάσταση παιχνιδιού έχει τα παρακάτω στοιχεία:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `game_id`                | Αντιστοίχιση σε ποιό game υπάγεται           | int                                 |
| `status  `               | Κατάσταση             | 'not active', 'initialized', 'started', 'aborded'     |
| `p_turn`                 | To χρώμα του παίκτη που παίζει        | 'B','R',null                              |
| `result`                 |  To χρώμα του παίκτη που κέρδισε |'B','R',null                              |
| `last_change`            | Τελευταία αλλαγή/ενέργεια στην κατάσταση του παιχνιδιού         | timestamp |

### Game
-------

| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `game_id`                | Αρίθμηση εν ενεργεία παιχνιδιών              | int                                 |